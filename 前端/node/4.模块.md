## æ¨¡å—

### 1.ä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—

â€‹	åœ¨node.jsä¸­ï¼Œæ¯ä¸€ä¸ªæ–‡ä»¶å®žé™…ä¸Šå°±æ˜¯ä¸€ä¸ªæ¨¡å—

### 2.require

require  =>  å¼•å…¥æ¨¡å—

* å¼•å…¥æ¨¡å—æ—¶ï¼Œnodeä¼šä¼˜å…ˆä»Žç¼“å­˜ä¸­å¼•å…¥æ¨¡å—ï¼Œé¿å…äº†é‡å¤å¼•å…¥çš„é—®é¢˜
  * requireç¼“å­˜ï¼šnodeä¼šè‡ªåŠ¨ç¼“å­˜requireè¿‡çš„æ¨¡å—,`ä½†æ˜¯ç¼“å­˜æ˜¯é€šè¿‡è·¯å¾„åˆ¤æ–­çš„ï¼Œç›¸åŒæ–‡ä»¶ä¸åŒè·¯å¾„ä¼šäº§ç”Ÿä¸¤ä»½ç¼“å­˜`
* requireå¼•å…¥æ¨¡å—æ—¶`åŒæ­¥çš„`



### 3.exportsä¸Žmodule.exports

* requireåŠ è½½çš„æ¨¡å—é€šè¿‡module.exportsæš´éœ²

* exportsæ˜¯å¯¹module.exportså¼•ç”¨ï¼š

  ![img](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/8/16/16c98da07872f7f3~tplv-t2oaga2asx-watermark.image)

* requireå¯¼å‡ºçš„å†…å®¹æ˜¯module.exportsçš„æŒ‡å‘çš„å†…å­˜å—å†…å®¹ï¼Œå¹¶ä¸æ˜¯exportsçš„ã€‚

> åœ¨ä½¿ç”¨çš„æ—¶å€™æ›´å»ºè®®å¤§å®¶ä½¿ç”¨module.exports



### 4.å°†å…¬ç”¨ä»£ç æŠ½æˆæ¨¡å—

```javascript
//âš¡ï¸åˆ›å»ºæ›¿æ¢æ¨¡ç‰ˆå­—ç¬¦ä¼ å‡½æ•°
function replaceTemplate(temp, product) {
    //æ¯æ¬¡è¿”å›žéƒ½æ˜¯å‰ä¸€æ¬¡æ›¿æ¢å®Œæˆçš„æ¨¡ç‰ˆæ–‡ä»¶ï¼ˆç‰›æ‰¹ðŸ¤™ï¼‰
    let output = temp.replace(/{%PRODUCTNAME%}/g, product.productName);
    output = output.replace(/{%IMAGE%}/g, product.image);
    output = output.replace(/{%PRICE%}/g, product.price);
    output = output.replace(/{%FROM%}/g, product.from);
    output = output.replace(/{%NUTRIENTS%}/g, product.nutrients);
    output = output.replace(/{%QUANTITY%}/g, product.quantity);
    output = output.replace(/{%DESCRIPTION%}/g, product.description);
    output = output.replace(/{%ID%}/g, product.id);
    if (!product.organic) {
        output = output.replace(/{%NOT_ORGANIC%}/g, 'not-organic');
    }
    return output;
}

module.exports = replaceTemplate;
```



### 5.æ¨¡å—è¯¦è§£ â°ï¼‰38

* æ¨¡å—è¿è¡Œçš„å…¨è¿‡ç¨‹![æˆªå±2021-09-03 ä¸‹åˆ4.01.41](https://raw.githubusercontent.com/player-404/images/main/%E6%88%AA%E5%B1%8F2021-09-03%20%E4%B8%8B%E5%8D%884.01.41.png)

1ï¼‰å¯¼å…¥æ–‡ä»¶

â€‹	è§£æžè·¯å¾„ï¼Œåˆ¤æ–­æ˜¯nodeæ¨¡å—ã€ç¬¬ä¸‰æ–¹æ¨¡å— è¿˜æ˜¯ è‡ªå·±åˆ›å»ºçš„æ¨¡å—

2ï¼‰åŒ…è£…å‡½æ•°

â€‹	ä¼šå°†æ–‡ä»¶ä»£ç åŒ…è£…åœ¨ä¸€ä¸ªå‡½æ•°å†…ï¼Œè¿™ä¸ªå‡½æ•°ä¼ å…¥äº†å‡ ä¸ªå‚æ•°ï¼Œå¦‚ä¸‹

```javascript
//æ–‡ä»¶ä»£ç ä¼šåŒ…è£…åœ¨è¯¥ç«‹å³æ‰§è¡Œå‡½æ•°ä¹‹ä¸­
ï¼ˆfunction(exports, require, module, __filename, __dirname) {
 			... 
	}ï¼‰
```

âœ¨è¿™ç§åšæ³•é¿å…äº†å˜é‡çš„å…¨å±€æ±¡æŸ“ï¼Œå¦‚å˜é‡ä¸Žæ¨¡å—åŒå

âœ¨æ¯ä¸ªæ¨¡å—éƒ½æœ‰è‡ªå·±çš„ç§æœ‰å˜é‡

* æŸ¥çœ‹åŒ…è£…å‡½æ•°çš„äº”ä¸ªå‚æ•°

```javascript
//æ–‡ä»¶ä¸­çš„ä»£ç å®žé™…åœ¨ä¸€ä¸ªåŒ…è£…å‡½æ•°ä¹‹ä¸­
console.log(arguments);
/* 
    [Arguments] {
  '0': {},
  '1': [Function: require] {
    resolve: [Function: resolve] { paths: [Function: paths] },
    main: Module {
      id: '.',
      path: '/Users/tom/Desktop/learn/node/2-how-node-works',
      exports: {},
      filename: '/Users/tom/Desktop/learn/node/2-how-node-works/modules.js',
      loaded: false,
      children: [],
      paths: [Array]
    },
    extensions: [Object: null prototype] {
      '.js': [Function (anonymous)],
      '.json': [Function (anonymous)],
      '.node': [Function (anonymous)]
    },
    cache: [Object: null prototype] {
      '/Users/tom/Desktop/learn/node/2-how-node-works/modules.js': [Module]
    }
  },
  '2': Module {
    id: '.',
    path: '/Users/tom/Desktop/learn/node/2-how-node-works',
    exports: {},
    filename: '/Users/tom/Desktop/learn/node/2-how-node-works/modules.js',
    loaded: false,
    children: [],
    paths: [
      '/Users/tom/Desktop/learn/node/2-how-node-works/node_modules',
      '/Users/tom/Desktop/learn/node/node_modules',
      '/Users/tom/Desktop/learn/node_modules',
      '/Users/tom/Desktop/node_modules',
      '/Users/tom/node_modules',
      '/Users/node_modules',
      '/node_modules'
    ]
  },
  '3': '/Users/tom/Desktop/learn/node/2-how-node-works/modules.js',
  '4': '/Users/tom/Desktop/learn/node/2-how-node-works'
}
*/
```

* æŸ¥çœ‹åŒ…è£…å‡½æ•°

```javascript
console.log(require("module").wrapper);
/* 
    [
  '(function (exports, require, module, __filename, __dirname) { ',
  '\n});'
]
*/
```



3ï¼‰ä»£ç æ‰§è¡Œ

4ï¼‰å¯¼å‡ºæ–‡ä»¶

â€‹	`modules.exports`è¿”å›žä¸€ä¸ª`å¯¹è±¡`ï¼Œå¯¼å‡ºçš„ä»£ç æ‰§è¡Œçš„ç»“æžœç­‰éƒ½ä¿å­˜åœ¨è¯¥å¯¹è±¡ä¸­

5ï¼‰æ¨¡å—ç¼“å­˜

â€‹	åœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œå®Œæˆå¯¼å‡ºåŽï¼Œè¯¥æ¨¡å—å°†ä¼šè¢«ç¼“å­˜ï¼Œå½“requireè¯¥æ¨¡å—æ—¶ï¼Œä¼šå°è¯•ä»Žç¼“å­˜ä¸­å–



æ¡ˆä¾‹ä¸€ï¼ˆè®¡ç®—å™¨ï¼‰:

ä½¿ç”¨module.exports

```javascript
module.exports = class {
  add(a, b) {
    return a + b;
  }
  sub(a, b) {
    return a - b;
  }
  mul(a, b) {
    return a * b;
  }
  div(a, b) {
    return a / b;
  }
};

```

ä½¿ç”¨exports

âœ¨è®°ä½exportsæ˜¯å¯¹mudol.exportså¯¹è±¡çš„å¼•ç”¨ï¼Œä¸å¯é‡æ–°èµ‹å€¼

```javascript
exports.add = (a, b) => {
  return a + b;
};

exports.mul = (a, b) => {
  return a * b;
};

exports.div = (a, b) => {
  return a / b;
};

exports.sub = (a, b) => {
  return a - b;
};

```

require

```javascript
const C = require("./module-1");
const calc = new C();
console.log(calc.add(2, 5));

const clac1 = require("./module-2");
console.log(clac1.add(2, 5));
```



