## Mogodb

### 1.å®‰è£…

### **mac**

æ¨èä½¿ç”¨brewå®‰è£…ï¼Œå‚ç…§[å®˜æ–¹æ–‡æ¡£](https://docs.mongodb.com/manual/tutorial/install-mongodb-on-os-x/)

1ï¼‰å°†DNSæ”¹ä¸º8.8.8.8

2ï¼‰brew tap mongodb/brew

3ï¼‰brew install mongodb-community@5.0

#### å¯åŠ¨æœåŠ¡

brew services start mongodb-community@5.0

#### ç»“æŸæœåŠ¡

brew services stop mongodb-community@5.0

#### è¿æ¥æœåŠ¡

mongosh

#### æ•°æ®åº“æ–‡ä»¶ä½ç½®

é€šè¿‡homebrewå®‰è£…çš„é»˜è®¤ä½ç½®: /usr/local/var/mongodb

æŸ¥çœ‹æ•°æ®åº“æ–‡ä»¶ä½ç½®å‘½ä»¤:  db.serverCmdLineOpts()



### **centeros**

[å‚ç…§å®˜æ–¹æ–‡æ¡£][https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/]

1ï¼‰é…ç½®mongoDB yumæº(å‚ç…§å®˜ç½‘ï¼Œéšæ—¶å¯èƒ½æ›´æ–°)

   	aï¼‰yumæºé…ç½®æ–‡ä»¶ç›®å½•ï¼š`/etc/yum.repos.d`

â€‹		bï¼‰åˆ›å»ºmongodb repoæ–‡ä»¶ `mongodb-org-5.0.repo`ï¼Œå†™å…¥ä»¥ä¸‹é…ç½®

```json
[mongodb-org-5.0]
name=MongoDB Repository
baseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/5.0/x86_64/
gpgcheck=1
enabled=1
gpgkey=https://www.mongodb.org/static/pgp/server-5.0.asc
```



2ï¼‰ä¸‹è½½å®‰è£…

â€‹	a) sudo yum install -y mongodb-org

â€‹	b) `etc/yum.conf`æ·»åŠ ä»¥ä¸‹é…ç½®

```json
exclude=mongodb-org,mongodb-org-database,mongodb-org-server,mongodb-org-shell,mongodb-org-mongos,mongodb-org-tools

```



3ï¼‰é…ç½®æ–‡ä»¶ä½ç½®

â€‹	a) æ•°æ®åº“æ–‡ä»¶ä½ç½®

â€‹		`/var/lib/mongo`

â€‹	b) logæ–‡ä»¶ä½ç½®

â€‹		`/var/log/mongodb`



4ï¼‰å¯åŠ¨

â€‹	sudo systemctl start mongod



5ï¼‰åœæ­¢

â€‹	sudo systemctl stop mongod



5ï¼‰é‡å¯

â€‹	sudo systemctl restart mongod



### 2.ä½¿ç”¨

1ï¼‰use ä½¿ç”¨/åˆ›å»º(æ•°æ®åº“ä¸å­˜åœ¨æ—¶)æ•°æ®åº“

`use db-name`



2ï¼‰æ’å…¥æ•°æ®

â€‹	a) åˆ›å»ºè¡¨å

â€‹		`db.è¡¨å`

â€‹	b)æ’å…¥æ•°æ®

â€‹		`insertMany`: æ’å…¥å¤šæ¡æ•°æ®

â€‹		`insertOne`ï¼šæ’å…¥ä¸€æ¡æ•°æ®

Eg: åˆ›å»ºtoursè¡¨ï¼Œå¹¶å‘å…¶ä¸­æ’å…¥ä¸€æ¡æ•°æ®

<img src="https://raw.githubusercontent.com/player-404/images/main/%E6%88%AA%E5%B1%8F2021-09-08%20%E4%B8%8A%E5%8D%8811.16.15.png" alt="æˆªå±2021-09-08 ä¸Šåˆ11.16.15" style="zoom:50%;float: left" />



3ï¼‰æŸ¥çœ‹è¡¨æ•°æ® =>  find()

`db.tours.find()`

<img src="https://raw.githubusercontent.com/player-404/images/main/%E6%88%AA%E5%B1%8F2021-09-08%20%E4%B8%8A%E5%8D%8811.18.30.png" alt="æˆªå±2021-09-08 ä¸Šåˆ11.18.30" style="float: left" width="60%"/>

âœ¨id: ä¸ºè‡ªåŠ¨åˆ›å»ºçš„å”¯ä¸€æ ‡è¯†ç¬¦

âœ¨mongodbæ•°æ®ç±»ä¼¼äºJSON,å®˜æ–¹å«åšBSON



4ï¼‰æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“ => show dbs

<img src="https://raw.githubusercontent.com/player-404/images/main/%E6%88%AA%E5%B1%8F2021-09-08%20%E4%B8%8A%E5%8D%8811.21.18.png" alt="æˆªå±2021-09-08 ä¸Šåˆ11.21.18" style="float: left" width="50%"/>



5ï¼‰æŸ¥çœ‹æ•°æ®åº“ä¸­çš„æ‰€æœ‰æ•°æ®è¡¨  =>  show collections

<img src="https://raw.githubusercontent.com/player-404/images/main/%E6%88%AA%E5%B1%8F2021-09-08%20%E4%B8%8A%E5%8D%8811.24.13.png" alt="æˆªå±2021-09-08 ä¸Šåˆ11.24.13" style="float: left" width="50%"/>



6ï¼‰æ’å…¥å¤šæ¡æ•°æ® => insetMany( [ ] )

![æˆªå±2021-09-08 ä¸‹åˆ3.25.22](https://raw.githubusercontent.com/player-404/images/main/%E6%88%AA%E5%B1%8F2021-09-08%20%E4%B8%8B%E5%8D%883.25.22.png)

â—æ’å…¥å¤šæ¡æ•°æ®æ—¶ï¼Œæ”¾åœ¨æ•°ç»„ä¸­



7ï¼‰æœç´¢æ•°æ® => find()

mongodbä½¿ç”¨`find`ä¼ å…¥ä¸€ä¸ªæœç´¢æ¡ä»¶å¯¹è±¡ï¼Œè¿›è¡Œæ•°æ®æœç´¢

 aï¼‰æœç´¢nameä¸ºå¼ ä¸‰çš„æ•°æ®

<img src="https://raw.githubusercontent.com/player-404/images/main/%E6%88%AA%E5%B1%8F2021-09-08%20%E4%B8%8B%E5%8D%883.37.23.png" alt="æˆªå±2021-09-08 ä¸‹åˆ3.37.23" style="float: left" width="60%"/>



bï¼‰ä½¿ç”¨è¿ç®—ç¬¦è¿›è¡Œæœç´¢ => $



â€‹	iï¼‰lte:  å°äºç­‰äº

â€‹		æœç´¢priceå°äº500çš„æ•°æ®

<img src="https://raw.githubusercontent.com/player-404/images/main/%E6%88%AA%E5%B1%8F2021-09-08%20%E4%B8%8B%E5%8D%883.40.53.png" alt="æˆªå±2021-09-08 ä¸‹åˆ3.40.53" style="float: left" width="60%"/>

â€‹	

â€‹	iiï¼‰lt:  å°äº & gte:  å¤§äºç­‰äº

â€‹			æœç´¢åŒæ—¶æœç´¢å¤šä¸ªæ¡ä»¶çš„æ•°æ®(æœç´¢ price < 500 ä¸” rating >= 4.5)

<img src="https://raw.githubusercontent.com/player-404/images/main/%E6%88%AA%E5%B1%8F2021-09-08%20%E4%B8%8B%E5%8D%883.51.53.png" alt="æˆªå±2021-09-08 ä¸‹åˆ3.51.53" width="76%" style="float: left"/>



cï¼‰$or è¿ç®—ç¬¦

æ¥å—ä¸€ä¸ªæ•°æ®ï¼Œæ•°ç»„ä¸­çš„æ¡ä»¶ä»»ä¸€æ»¡è¶³å³å¯

æœç´¢ä»·æ ¼å°äº500 æˆ–è€… è¯„åˆ†å¤§äºç­‰äº4.8çš„æ•°æ®

<img src="https://raw.githubusercontent.com/player-404/images/main/%E6%88%AA%E5%B1%8F2021-09-08%20%E4%B8%8B%E5%8D%883.57.56.png" alt="æˆªå±2021-09-08 ä¸‹åˆ3.57.56" style="float: left" width="76%"/>



8ï¼‰æœç´¢åˆ°çš„æ•°æ®æŒ‡å®šæ˜¾ç¤ºå­—æ®µ

â€‹	aï¼‰æœç´¢çš„ç»“æœåªæ˜¾ç¤ºnameå­—æ®µ `{name: 1}`		<img src="https://raw.githubusercontent.com/player-404/images/main/%E6%88%AA%E5%B1%8F2021-09-08%20%E4%B8%8B%E5%8D%884.05.49.png" alt="æˆªå±2021-09-08 ä¸‹åˆ4.05.49" style="float: left" width="%"/>



bï¼‰æœç´¢çš„ç»“æœä¸æ˜¾ç¤ºnameå­—æ®µ `{name: 0}`![æˆªå±2021-09-08 ä¸‹åˆ4.07.09](https://raw.githubusercontent.com/player-404/images/main/%E6%88%AA%E5%B1%8F2021-09-08%20%E4%B8%8B%E5%8D%884.07.09.png)



9ï¼‰æ›´æ–°æ•°æ® => $set

â€‹	âœ¨ä½¿ç”¨æ›´æ–°æ–¹æ³•ï¼Œä¼ å…¥ä¸¤ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªå¯¹è±¡ä¸ºæœç´¢æ¡ä»¶ï¼Œç¬¬äºŒä¸ªå¯¹è±¡ä¸ºæ›´æ–°æ•°æ®

â€‹	aï¼‰æ›´æ–°ä¸€æ¡æ•°æ® => updateOne

â€‹	â—ï¸å³ä½¿åŒ¹é…åˆ°å¤šæ¡æ•°æ®ï¼Œä¹Ÿåªä¼šæ›´æ–°åŒ¹é…åˆ°çš„ç¬¬ä¸€æ¡æ•°æ®	![æˆªå±2021-09-08 ä¸‹åˆ4.18.43](https://raw.githubusercontent.com/player-404/images/main/%E6%88%AA%E5%B1%8F2021-09-08%20%E4%B8%8B%E5%8D%884.18.43.png)



bï¼‰æ›´æ–°å¤šæ¡æ•°æ® => updateMany

â€‹	ğŸ“ å°†è¯„åˆ†å¤§äºç­‰äº4.8ï¼Œä»·æ ¼å¤§äº500çš„æ•°æ®ï¼Œæ·»åŠ premiumå±æ€§ï¼Œå€¼ä¸ºtrue

![æˆªå±2021-09-08 ä¸‹åˆ4.38.15](https://raw.githubusercontent.com/player-404/images/main/%E6%88%AA%E5%B1%8F2021-09-08%20%E4%B8%8B%E5%8D%884.38.15.png)

âœ¨è¿™ä¸ªæ–¹æ³•ä¼šæ›´æ–°æ‰€æœ‰åŒ¹é…åˆ°çš„æ•°æ®

âœ¨$set æ›´æ–°æŒ‡å®šæ•°æ®æ—¶ï¼Œæ²¡æœ‰æ‰¾åˆ°æŒ‡å®šçš„æ›´æ–°å±æ€§ï¼Œåˆ™ä¼šåˆ›å»ºè¯¥å±æ€§



10ï¼‰æ›¿æ¢æ•°æ® replaceOne & replaceMany

âœ¨ replaceOne & replaceMany æ¥æ”¶ä¸¤ä¸ªå¯¹è±¡ï¼Œç¬¬ä¸€ä¸ªæ—¶åŒ¹é…æ¡ä»¶ï¼Œç¬¬äºŒä¸ªæ—¶æ›¿æ¢çš„æ–‡æ¡£

â—ï¸æ›¿æ¢æ•°æ®ä¸å†éœ€è¦ä½¿ç”¨ $set 

â—ï¸æ•°æ®å°†ä¼šæ•´ä¸ªè¢«æ›¿æ¢ä¸ºç¬¬äºŒä¸ªå‚æ•°å¯¹è±¡ï¼Œè€Œä¸æ˜¯æ›´æ–°æŸä¸ªå±æ€§

![æˆªå±2021-09-08 ä¸‹åˆ4.58.20](https://raw.githubusercontent.com/player-404/images/main/%E6%88%AA%E5%B1%8F2021-09-08%20%E4%B8%8B%E5%8D%884.58.20.png)
